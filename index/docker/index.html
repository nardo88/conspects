<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        a {
            text-decoration: none;
            font-weight: 500;
            color: #0088f8;
        }

    </style>
</head>
<body>
    <h1>Docker</h1>
    <h2>Установка</h2>
    <p>Для установки <b>Docker</b> необходимо скачать установщик для своей ОС (Если старый Windows? например win 8 и ниже то необходимо скачать DockerToolbox)</p>
    <p>Установка тривиальная, единственно, то что потребуется использование VirtualBox, но он установится вместе с диструбутивом DockerToolbox. После установки на рабочем столе появится ярлык <b>Docker Quickstart Terminal</b>. Этот ярлык необходимо запускать с правами администратора. При первом запуске, Docker закачает линуксовую оболочку, внутри которой будут запускаться образы приложения. После успешной установки мы увидим вот такой результат:</p>
    <img src="./prim1.jpg" alt="">
    <h2>Проверка установки</h2>
    <p>После установки Docker вводим в консоли докера вот такую команду</p>
    <span class="code">docker version</span>
    <p>В результате мы увидим это:</p>
    <img src="./prim2.jpg" alt="">
    <p>Что бы посмотреть все контейнеры в системе вводим команду</p>
    <span class="code">docker ps -a</span>
    <p>Вот результат</p>
    <img src="./prim3.jpg" alt="">
    <h2>Изучение образов и контейнеров</h2>
    <p><b>Образ</b> - представляет из себя файловую систему с параметрами используемыми при запуске. Он не имеет состояния и никогда не меняется</p>
    <p><b>Контейнер</b> - является запущенным экземпляром образа. Когда вы выполняете команду запуска, Docker Engine</p>
    <p>Docker
        <ul>
            <li>проверяет существует ли образ</li>
            <li>скачивает образ с Docker Hub</li>
            <li>загружает образ в контейнер и запускает его</li>
        </ul>
    </p>
    <h2>Поиск и запуск существующего образа</h2>
    <p>По всему миру люди создают Docker образы. Вы можете искать и просматривать эти образы на Docker Hub.</p>
    <h3><span class="num">1</span> Поиск образа whalesay</h3>
    <p>Откройте в вашем браузере <a href="https://hub.docker.com/" target="_blank">Docker Hub</a></p>
    <p>В строке поиска вводим <b>whalesay</b></p>
    <img src="./prim4.jpg" alt="">

    <p>Кликните по docker/whalesay образу в результатах поиска. Браузер отобразит репозиторий для образа whalesay.</p>
    <img src="./prim5.jpg" alt="">
    <p>Каждый репозиторий образа содержит информацию о разновидностях содержащегося программного обеспечения и о том как им пользоваться. Нужно заметить что образ whalesay основан на дистрибутиве Ubuntu.На следующем шаге, вы запустите образ whalesay на вашем компьютере.</p>
    <h3><span class="num">2</span> Запуск образа whalesay</h3>
    <ul>
        <li>Откройте терминал командной строки.</li>
        <li>
            <p>Введите команду <span class="code">docker run docker/whalesay cowsay boo</span> и выполните ее.</p>
            <p>Эта команда запускает образ whalesay в контейнере. Результат выполнения будет примерно таким:</p>
            <img src="./prim6.jpg" alt="">
            <p>При первом запуске образа, команда docker ищет образ в вашей системе. Если образ не обнаружен, то docker скачает его с Docker Hub.</p>
        </li>
        <li>
            <p>Пока вы до сих пор находитесь в терминале командной строки, введите команду <span class="code">docker images</span>.</p>
            <p>Команда отображает список образов в локальной системе. В результате вы увидите docker/whalesay в этом списке</p>
            <img src="./prim7.jpg" alt="">

        </li>
        <li>Найдите минутку что бы поиграть с контейнером whalesay. для этого вводим команду <span class="code">docker run docker/whalesay cowsay boo-boo</span></li>
    </ul>
    <h2>настройка локального рабочего окружения для PHP-проектов</h2>
    <p>На нашем АРМ должен быть установлен Docker и Docker-Compose для проверки можем ввести команды для проверки (все команды вводим обязательно через Docker Quickstart Terminal):</p>
    <span class="code">docker -v</span> <br> <br> <br>
    <span class="code">docker-compose -v</span>
    <p>Для просмотра образов вводим команду:</p>
    <span class="code">docker images</span>
    <p>Для просмотра контейнеров вводим:</p>
    <span class="code">docker ps -a</span>
    <p>В папке с проектом создаем файл с именем <b>Dockerfile</b>. В этом файле мы можем выполнять n-ое количество команд</p>
    <p>На хабе Docker ищем образ php + apache</p>
    <img src="./prim8.jpg" alt="">
    <p>Заходим внутрь него</p>
    <img src="./prim9.jpg" alt="">
    <p>Нам нужн образ который сразу идет с apache? например нам подходит версия образа 3.3.7-apache, для его установки мы вводим вот такую команду:</p>
    <span class="code">docker pull php:3.3.7-apache </span>
    <ul>
        <li>docker - обращаемся к docker</li>
        <li>pull - это значит загрузить</li>
        <li>php - это вендор т.е. название образа, через твоеточие мы указываем версию образа которую выюрали на странице вендора</li>
    </ul>
    <p>Теперь если ввести в терминале Docker список образов то мы увидим там установленный php + apache</p>
    <p>Следующее что нам надо установить - это <b>composer</b></p>
    <p>Для этого вводим команду:</p>
    <span class="code">docker pull composer</span>
    <p>Теперь для проверки в нашем проекте создадим папку docker и в ней создадим файл php который назовем command с вот такми содержимым:</p>
    <img src="./prim10.jpg" alt="">
    <p>Теперь что бы запустить наш скрипт вводим в терминале докера вот такую команду:</p>
    <span class="code">docker run --rm -v $(pwd):/app php:7.3.3-apache php /app/command.php</span>
    <ul>
        <li>run - запустить</li>
        <li>--rm - одноразовый контейнер, т.е. после выполнения он удалится</li>
        <li>-v $(pwd):/app - эта строчка читается так: скопировать (-v) из директории проекта ($(pwd) - эта команда возвращает полный путь до папки нашего проекта) в директорию виртуальной оболочки (:/app - т.е. в корне виртуальной оболочки создастся папка app)</li>
        <li>php:7.3.3-apache - какой запустится образ т.е. в нашем случае это php:7.3.3-apache</li>
        <li>php /app/command.php - какой скрипт должен будет выполниться (т.е. в виртуальной среде будет запущен файл /app/command.php) </li>
    </ul>
    <p>В итоге после выполнения этой команды мы должны увидеть в консоли вот такую картину</p>
    <img src="./prim11.jpg" alt="">
    <p>Теперь создадим не одноразовый контейнер, например запустим контейнер к которому мы достучимся через браузер, т.е. у нас запустится вебсервер apache с работающим php сервером и через который мы откроем сайт в браузере</p>
    <p>В проекте создадим файл index.php и внутри он будет содержать вот такой код:</p>
    <img src="./prim12.jpg" alt="">
    <p>Теперь вызов нашего скрипта будет выглядеть вот так:</p>
    <span class="code">docker run -p 8080:80 -v $(pwd):/var/www/html php:7.3.3-apache</span>

    <ul>
        <li>-v $(pwd):/var/www/html - поместить наши файлы из директории нашего проекта в ращдел на виртуальной среде - /var/www/html - это путь для запуска файлов у веб сервера</li>
        <li>-p 8080:80 - нам будет доступен веб сервер по 8080 порту а работать он будет как стандартный 80 порт</li>
        <li></li>
        <li></li>
    </ul>


</body>
</html>