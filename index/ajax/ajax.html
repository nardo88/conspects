<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<h1>AJAX</h1>
	<p><b>AJAX</b> - это технология которая позволяет получать данные от сервера не перезагружая страницу.</p>
	<h3>Полный контроль. Пример 1</h3>
	<p>Рассмотрим следующую задачу. У нас будет поле ввода input, в которое мы будем вводить число. После нажатия на кнопку это число на стороне сервера будет умножаться на 2, затем возвращаться на сторону клиента и будет выводиться в value второго поля ввода. и все это без перезагрузки страницы.</p>
	<p>сначала рассмотрим код html:</p>
	<img src="prim1.jpg" alt="">
	<p>Все по минимуму одна кнопка и два поля ввода</p>
	<p>Теперь рассмотрим код JavaScript</p>
	<img src="prim2.jpg" alt="">
	<p>Первое что мы делаем это создаем переменные - экземпляры объектов нашей кнопки и полей ввода.</p>
	<p>Затем мы обращаемся нашей кнопке и прослушиваем событие <b>click</b>, в случае события выполняется функция <b>funIn</b></p>
	<p>Теперь рассмотрим эту функцию:</p>
	<p>При помощи библиотеки <b>jQuery</b> мы вызываем метод <b>ajax</b>. Входящим параметром этого метода является массив. Подробнее об элементах массива можно почитать <a href="https://basicweb.ru/jquery/jquery_method_ajax.php" target="_blank">здесь</a>. Ну а мы рассмотрим основные элементы этого массива:</p>
	<ul>
		<li><b>url:</b> - указывается php файл где будет происходить обработка данных</li>
		<li><b>type:</b> - метод передачи данных. В php два метода: POST и GET</li>
		<li><b>data:</b> - какие данные мы передаем. В примере мы передаем переменную name которой присвоено значение value поля с классом "in"</li>
		<li><b>dataType:</b> - тип данных, может быть text, html и т.д.</li>
		<li><b>beforeSend:</b> - функция обратного вызова, которая будет вызвана перед осуществлением AJAX запроса т.е. пока запрос не будет выполнен будет выполняться функция которая указана в этом разделе. Для чего это? с ее помощью мы можем сделать функцию которая быдет например выводить на экран идет загрузка</li>
		<li><b>success:</b> - Функция обратного вызова, которая вызывается если AJAX запрос выполнится успешно. В нашем случае это функция <b>funOut</b></li>
	</ul>
	<p>Теперь рассмотрим саму функцию <b>funOut</b></p>
	<p>Входящим параметром этой функции обязательно долен атрибут <b>data</b>. Этот атрибут содержит в себе данные которые возвратил наш файл php на сервере.</p>
	<p>немного прервемся для того что бы рассмотреть фойл php что бы потом вернуться к нашей функции <b>funOut</b></p>
	<p>Код php:</p>
	<img src="prim3.jpg" alt="">
	<p>Итак в наш фал php методом POST пришли данные из переменной name. Значит все данные в php попали в ассоциативный массив. Обращаться к этому мссиву мы можем как обычно: $_POST["имя_элемента"]</p>
	<p>Хохмы ради мы создали здесь оператор условия. Если значение параметра name будет равно 1, то вызвращается значение fail (возвращение идет через метод echo)</p>
	<p>Иначе, мы наше значение элемента массива умножаем на 2 и возвращаем результат. Т.е. значение возращаемое значение php файла будет либо fail либо число умноженное на 2</p>
	<p>Теперь вернемся к нашей функции в JAVASCRIPT</p>
	<p>Здесь если значение data равно  fail вызывается метод allert с надписью "занято", иначе - мы присваиваем наше значение в поле OUT</p>
	<br>
	<br>
	<br>
	<h3>JSON. Пример 2</h3>
	<p>Предыдущий пример работает только в том случае если нам надо вернуть одно значение. А что если нам надо с сервера получить массив значений. Например данные из базы данных. Для этого используется метод <b>JSON</b></p>
	<p>Рассмотрим пример: цель - в зависимости от введенного значения поля input будут выводиться определенные значения. К примеру, в поле введем "макс" жмем кнопку и остальные поля заполняются данным пола, возраста и профессии</p>
	<p>Рассмотрм код html:</p>
	<img src="prim4.jpg" alt="">
	<p>Поле ввода, кнопка и три поля вывода</p>
	<p>Код JavaScript</p>
	<img src="prim5.jpg" alt="">
	<p>Так же объявляем три переменные - экземпляры объектов (кнопка и поля ввода/вывода)</p>
	<p>Так же прослушиваем событие <b>click</b> у кнопки по которому вызываем функцию.</p>
	<p>В функции мы с помощь. jQuery вызываем уже метод get (можно и post, но тогда в php файле используем POST)</p>
	<p>Входящим параметром метода get так же является массив:</p>
	<ul>
		<li><b>array.php</b> - где будут образатываться данные</li>
		<li><b>{name: newvalue.value}</b> - какие данные передаем (переменная name которая принимает значение поля ввода newvalue)</li>
		<li><b>fun2</b> - функция которая будет выполнена при успешном выполнении запроса</li>
	</ul>
	<p>Перед тем как разбирать вторую функцию рассмотрим код php:</p>
	<img src="prim6.jpg" alt="">
	<p>Если значение элемента ассоциативного массива с индексом name равно "макс", то методом <b>json_encode</b> возвращается массив значений. А дальше ассоциативный массив со значениями. Идентификатораи элементом являются пол, возраст и профессия.</p>
	<p>Так проверяется два значения, если ни первое ни второе не подходит возвращается слово "fail"</p>
	<p>Теперь вернемся к нашей второй функции в JavaScript</p>
	<p>Здесь так же обязательно входным параметром является атрибут data. Внутри функции идет оператор сравнения: если значение data равно "fail" то вызывается метод alert с уведомлением. Иначе - мы включаем <b>JSON.parse</b> (парсинг значений data). Только после этого мы можем обращаться к массиву полученных значений используя идентификаторы ассоциативного массива. В значения полей мы помещаем те значения который вернул нам файл php</p>

</body>
</html>